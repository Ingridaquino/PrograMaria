"use strict";function _defineProperty(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),AppModal=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"init",value:function(){this.isMobile=window.screen.width<992,this.allCookies=document.cookie,this.cookiename="modalapp=",this.isMobile?(this.closeButton=document.querySelectorAll(".js_appModalMobile-close"),this.modal=document.getElementById("appModalMobile"),this.cookieTimer="86400"):(this.closeButton=document.querySelectorAll(".js_appModalDesktop-close"),this.openButton=document.querySelectorAll(".js_appModalDesktop-open"),this.modal=document.getElementById("appModalDesktop"),this.cookieTimer="604800"),this.modal&&(this.addOpenButtonListener(),this.addCloseButtonListener(),this.isMobile?this.controlMobileCookie():this.controlDesktopCookie())}},{key:"controlDesktopCookie",value:function(){var e=this;this.checkCookie()?this.closeModal():(this.setCookie(),setTimeout(function(){e.openModal()},3e3))}},{key:"controlMobileCookie",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"start";"click"===e?this.setCookie():this.checkCookie()||this.openModal()}},{key:"setCookie",value:function(){document.cookie=this.cookiename+"; max-age="+this.cookieTimer+"; path=/"}},{key:"checkCookie",value:function(){var e=this;return this.allCookies.split(";").some(function(t){return t.includes(e.cookiename)})}},{key:"addOpenButtonListener",value:function(){var e=this;this.openButton&&this.openButton.length>0&&this.openButton.forEach(function(t){t.addEventListener("click",function(t){e.openModal()})})}},{key:"addCloseButtonListener",value:function(){var e=this;this.closeButton&&this.closeButton.length>0&&this.closeButton.forEach(function(t){t.addEventListener("click",function(t){e.closeModal(),e.isMobile&&e.controlMobileCookie("click")})})}},{key:"closeModal",value:function(){this.modal.classList.remove("is_active")}},{key:"openModal",value:function(){this.modal.classList.add("is_active")}}]),e}(),appModal=new AppModal;!function(){window.app={bindGlobal:function(){FastClick.attach(document.body),$(".timeago").timeago(),$(document).trigger("app:bind:global")},bindOpenOnLoad:function(){var e=$(".js-open-on-load");e.length>0&&$.each(e,function(e,t){window.open($(t).attr("href"))}),$(document).trigger("app:bind:open_on_load")},bindTooltips:function(){$("body").tooltip("destroy").tooltip({selector:'[data-toggle="tooltip"]'}),$(document).trigger("app:bind:tooltips")},checkFormValidity:function(e){var t=e.currentTarget,o=$(t).find('button[type="submit"]');t.checkValidity()?o.removeAttr("disabled"):o.attr("disabled","disabled"),$(document).trigger("app:bind:check_form_validity")},bindCepService:function(){$(document).on("cep-result",function(e,t){t&&($('input[name="user[address_attributes][street]"]').val(t.street),$('input[name="user[address_attributes][city]"]').val(t.city),$('input[name="user[address_attributes][state]"]').val(t.state),$('input[name="user[address_attributes][district]"]').val(t.neighborhood),$('input[name="user[address_attributes][complement]"]').val(t.complement))})},bindValidationCpf:function(){var e=$("#user-cpf");e.data("validate-cpf")&&e.on("keyup",function(){var e=$(this),t=e.parent(),o=$("<span />",{"class":"color-danger",text:"O cpf preenchido é inválido."}),n=e.parents("form").find('button[type="submit"], input[type="submit"]'),a=t.find(".color-danger"),s=CPF.validate(e.val());a.size()<1&&!s&&""!==e.val()&&(e.after(o),n.prop("disabled",!0)),(s||""===e.val())&&(a.remove(),n.prop("disabled",!1))})},init:function(){app.bindGlobal(),app.bindRecaptcha(),app.bindBlazy(),app.bindOpenOnLoad(),app.bindMasks(),app.bindTooltips(),app.bindReadMore(),app.bindDatepicker(),app.bindFixOnScroll(),app.ckeditor.bindCkeditor(),app.bindCheckout(),app.bindForumFeed(),app.bindCourseRating(),app.deadpoolChat.bindDeadpool(),app.lessonList.init(),app.chat.init(),app.studentDoubts.init(),app.notepad.init(),app.categoryList.init(),app.bindExamQuestionForm(),app.changeTimeZone(),app.followBind(),app.lessonPage(),app.timeTags(),app.bindPostsForm(),app.accessibility(),app.bindStrongPassword(),app.bindValidationCpf(),app.randomQuizStatistics(),app.bindCepService(),appModal.init(),$(document).on("app:bind:ckeditor_submit",app.bindCollaborativeDiscussion)}}}(),function(){app.bindBlazy=function(e){new Blazy,$(document).trigger("app:bind:blazy")}}(),function(){app.categoryList={init:function(){var e=this;e.$categoryList=$("#js-category-list"),0!=e.$categoryList.length&&(e.isActive=e.$categoryList.data("is-active")||e.isActive,e.isActive||(e.bindClicks(),e.$categoryList.attr("data-is-active",!0),e.isActive=!0),e.expandParents())},bindClicks:function(){var e=this;$(document).on("click","#js-category-list .category-item .toggle-btn",function(){e.expandParent($(this).parent(".category-item"),!0)})},expandParent:function(e,t){var o=e.find(".list-group").first(),n=e;t?o.stop().slideToggle("fast"):o.stop().toggle(),n.toggleClass("expanded")},expandParents:function(){for(var e=this,t=e.$categoryList.find(".category-item.current").first();t;){e.expandParent(t,!1);var o=t.parents(".category-item").first();t=o.length>0?o:null}}}}(),function(){app.chat={groupsPagination:{page:0,perPage:5,totalPages:0},collaboratorsPagination:{page:0,perPage:5,totalPages:0},followsPagination:{page:0,perPage:5,totalPages:0},init:function(){var e=this;e.$chat=$(".js-chat"),e.$chat.length<=0||(e.$groups=$(".js-groups",e.$chat),e.$students=$(".js-students",e.$chat),e.$roomTitle=$("#js-room-title"),e.$roomUsersCount=$("#js-room-users-count"),e.$text=$(".js-chat-text"),e.$messagesContainer=$(".js-chat-messages .js-content"),e.$messagesScroll=$(".js-chat-messages .js-scroll"),e.$sendForm=$("#js-send-messages"),e.$loadMoreGroupsButton=e.$chat.find(".js-load-more-groups"),e.$loadMoreCollaboratorsButton=e.$chat.find(".js-load-more-collaborators"),e.$loadMoreStudentsButton=e.$chat.find(".js-load-more-students"),e.$generalChatGroup=e.$chat.find(".js-chat-group-general"),e.user=e.$chat.data("user"),e.schoolId=e.$chat.data("school-id"),e.apiKey=e.$chat.data("api-key"),e.userId=e.user.id,e.chatType=e.$chat.data("type"),e.chatLesson=e.$chat.data("lesson"),e.bindScroll(),e.$messagesContainer.empty(),e.$text.keyup(function(t){var o=t.keyCode?t.keyCode:t.which;13!==o||t.shiftKey||e.submitMessage(t)}),app.simpleEditor.init("#js-send-messages"),e.$sendForm.on("submit",e.submitMessage),firebase.apps.length<=0&&firebase.initializeApp(window.CHAT_CONFIG),e.database=firebase.database(),e.authenticate(),"lesson-chat"===e.chatType?(e.lessonRoomUsers=e.database.ref("lesson_room_users/"+e.chatLesson.id),e.$loadMoreStudentsButton.hide(),e.changeRoom(null),e.registerCurrentUser(),e.loadRoomOnlineUsers(),$(document).off("page:before-change").on("page:before-change",function(){e.userFirebase&&e.userFirebase.remove()})):(e.loadSchoolGroup(),e.loadGroups(),e.loadCollaborators(),e.loadFollows(),e.$loadMoreGroupsButton.on("click",function(){e.loadGroups()}),e.$loadMoreCollaboratorsButton.on("click",function(){e.loadCollaborators()}),e.$loadMoreStudentsButton.on("click",function(){e.loadFollows()}),e.$generalChatGroup.on("click",function(){e.changeRoom({currentTarget:e.$generalChatGroup})})),e.listenConnectionChanges())},authenticate:function(){var e=app.chat;$.ajax({url:window.CHAT_FIREBASE_SERVICE_HOST+"/authenticate",method:"POST",headers:{Authorization:e.apiKey}}).success(function(t){firebase.auth().signInWithCustomToken(t.body.firebase_token).then(function(t){e.monitorConnectionState(t)})["catch"](function(e){console.error("Error creating custom token:",e)})}).error(function(e){console.error("Could not authenticate",e)})},monitorConnectionState:function(e){var t=firebase.database().ref("user_status").child(e.uid);firebase.database().ref(".info/connected").on("value",function(e){e.val()&&(t.onDisconnect().set("offline"),t.set("online"))}),document.onIdle=function(){t.set("idle")},document.onAway=function(){t.set("away")},document.onBack=function(){t.set("online")}},listenConnectionChanges:function(){var e=app.chat,t=this.database.ref("user_status");t.on("child_added",function(t){e.updateStatus(t.val(),t.key)}),t.on("child_changed",function(t){e.updateStatus(t.val(),t.key)}),t.on("child_removed",function(t){e.updateStatus(t.val(),"offline")})},updateStatus:function(e,t){var o=this,n=$('*[data-id="'+t+'"]');"lesson-chat"===o.chatType?"offline"===e&&(n.length&&n.remove(),o.lessonRoomUsers.orderByChild("id").equalTo(Number(t)).once("value").then(function(e){e.hasChildren()&&e.forEach(function(e){o.lessonRoomUsers.child(e.key).remove()}),o.$roomUsersCount.html($(".chat-profile-list-item",o.$students).length)})):n.length&&$(".status .icon",n).first().attr("class","icon icon-"+e)},bindScroll:function(){var e=this.$chat.data("height"),t=this.$chat.data("parent"),o=t?$(t).height():$(window).height(),n=e.indexOf("%")>-1;e=Number(e.replace("%","").replace("px","")),n===!0?this.chatHeight=o/100*e:this.chatHeight=e,this.$chat.height(this.chatHeight),this.$chat.find(".js-sidebar-scroll").scrollbar({}),this.$chat.find(".js-chat-messages .js-scroll").scrollbar({})},sanitizeHtml:function(e){return e.find("div:empty").remove(),e.children().each(function(e,t){var o=$(t);"BR"!==t.tagName&&o.find("br").length>0&&o.find("br").length==o.children().length&&o.remove()}),"BR"===e.last().get(0).tagName&&e.last().remove(),e},submitMessage:function(e){function t(e){return e<10?"0"+e:e}e.preventDefault();var o=app.chat,n=o.sanitizeHtml(o.$text),a=n.html();if(!(a.length<=0)){o.$text.html("").focus();var s=new Date;o.messages.push({id:o.user.id,name:o.user.first_name,avatar_url:o.user.cover_image_url,text:a,timestamp:moment().unix(),schedule:t(s.getHours())+":"+t(s.getMinutes())})}},scrollToEnd:function(){var e=this;e.$messagesScroll.scrollTop(e.$messagesScroll[0].scrollHeight)},renderMessage:function(e){var t=app.chat,o=t.renderTemplate("chat-message",{avatar:e.avatar_url,name:e.name,text:e.text,schedule:moment.unix(e.timestamp).format("LLL")});t.$messagesContainer.append(o),t.scrollToEnd()},renderTemplate:function(e,t){var o=$("#"+e+"-template").html(),n=Liquid.parse(o);return n.render(t)},loadMessages:function(){var e=app.chat,t=function(t){e.renderMessage(t.val())}.bind(e);e.messages.limitToLast(12).on("child_added",t),e.messages.limitToLast(12).on("child_changed",t)},loadRoomOnlineUsers:function(){var e=app.chat,t=function(t){var o=$(e.renderTemplate("chat-profile-list-item",t.val()));$(".js-students",e.$chat).append(o),e.$roomUsersCount.html($(".chat-profile-list-item",e.$students).length)}.bind(e),o=function(t){$('.js-students [data-id="'+t.val().id+'"]').remove(),e.$roomUsersCount.html($(".chat-profile-list-item",e.$students).length)}.bind(e);e.lessonRoomUsers.on("child_added",t),e.lessonRoomUsers.on("child_removed",o)},loadSchoolGroup:function(){var e=app.chat;$.ajax({url:window.CORE_HOST+"/chat/school_group",method:"GET",headers:{Authorization:"Token token="+e.apiKey}}).success(function(t){t.is_school=!0;var o=$(e.renderTemplate("chat-group-list-item",t));o.on("click",app.chat.changeRoom),e.$groups.prepend(o)})},loadGroups:function(){var e=app.chat;e.$loadMoreGroupsButton.attr("disabled","disabled"),$.ajax({url:window.CORE_HOST+"/chat/groups?per_page="+e.groupsPagination.perPage+"&page="+(e.groupsPagination.page+1),method:"GET",headers:{Authorization:"Token token="+e.apiKey}}).success(function(t){e.groupsPagination.page=e.groupsPagination.page+1,e.$loadMoreGroupsButton.removeAttr("disabled","disabled"),e.groupsPagination.totalPages=t.total_pages,e.groupsPagination.page>=e.groupsPagination.totalPages&&e.$loadMoreGroupsButton.attr("disabled","disabled");var o=t.groups;o=_.sortBy(o,{is_school:!1}),o=_.map(o,function(e){return e.is_school=!1,e}),o.forEach(function(t){var o=$(e.renderTemplate("chat-group-list-item",t));o.on("click",app.chat.changeRoom),e.$groups.append(o)}),e.selectFirstRoomAvailable()})},loadCollaborators:function(){var e=app.chat;e.$loadMoreCollaboratorsButton.attr("disabled","disabled"),$.ajax({url:window.CORE_HOST+"/chat/collaborators?per_page="+e.collaboratorsPagination.perPage+"&page="+(e.collaboratorsPagination.page+1),method:"GET",headers:{Authorization:"Token token="+e.apiKey}}).success(function(t){e.collaboratorsPagination.page=e.collaboratorsPagination.page+1,e.$loadMoreCollaboratorsButton.removeAttr("disabled","disabled"),e.collaboratorsPagination.totalPages=t.total_pages,e.collaboratorsPagination.page>=e.collaboratorsPagination.totalPages&&e.$loadMoreCollaboratorsButton.attr("disabled","disabled"),e.addProfileItems(t.collaborators,"js-team"),e.selectFirstRoomAvailable()})},loadFollows:function(){var e=app.chat;e.$loadMoreStudentsButton.attr("disabled","disabled"),$.ajax({url:window.CORE_HOST+"/chat/follows?per_page="+e.followsPagination.perPage+"&page="+(e.followsPagination.page+1),method:"GET",headers:{Authorization:"Token token="+e.apiKey}}).success(function(t){e.followsPagination.page=e.followsPagination.page+1,e.$loadMoreStudentsButton.removeAttr("disabled","disabled"),e.followsPagination.totalPages=t.total_pages,e.followsPagination.page>=e.followsPagination.totalPages&&e.$loadMoreStudentsButton.attr("disabled","disabled"),e.addProfileItems(t.users,"js-students"),e.selectFirstRoomAvailable()})},registerCurrentUser:function(){var e=this;e.lessonRoomUsers.orderByChild("id").equalTo(e.user.id).once("value").then(function(t){t.hasChildren()||e.lessonRoomUsers.push(e.user).then(function(t){e.userFirebase=t})})},addProfileItems:function(e,t){var o=app.chat;e.forEach(function(e){var n=$(o.renderTemplate("chat-profile-list-item",e));n.on("click",app.chat.changeRoom),$("."+t).append(n)})},changeRoom:function(e){var t=app.chat;$(".chat-sidebar-list-item").removeClass("active");var o="messages";if("lesson-chat"===t.chatType)o+="_lessons/"+t.chatLesson.id,t.$roomTitle.html(t.chatLesson.title),t.$roomUsersCount.html(0);else{var n=$(e.currentTarget);if(n.addClass("active"),"products"===n.data("type"))o+="_products/"+n.data("id"),t.$roomTitle.html($(".js-chat-group-name",n).html()),t.$roomUsersCount.html($(".js-chat-group-users-count",n).html());else if("users"===n.data("type")){var a=[t.userId,parseInt(n.data("id"))].sort();o+="_users/"+a[0]+"/"+a[1],t.$roomTitle.html($(".info .name",n).html()),t.$roomUsersCount.html($(".info .location",n).html())}else"schools"===n.data("type")&&(o+="_schools/"+t.schoolId,t.$roomTitle.html($(".js-chat-group-name",n).html()),t.$roomUsersCount.html($(".js-chat-group-users-count",n).html()))}t.$messagesContainer.html(""),t.messages&&t.messages.off(),t.messages=t.database.ref(o),t.loadMessages()},selectFirstRoomAvailable:function(){self.$selectedRoom||(self.$selectedRoom=$(".chat-sidebar-list-item").first(),self.$selectedRoom.click())}}}(),function(){app.bindCheckout=function(){$("#js-terms-of-use-check").change(function(){$(this).is(":checked")===!0?$(".cta-checkout-cart").removeClass("disabled"):$(".cta-checkout-cart").addClass("disabled")}),$(document).trigger("app:bind:checkout")}}(),function(){app.ckeditor={bindCkeditor:function(){var e="//cdn.edools.com/libs/ckeditor/4.5.10/ckeditor.js";$(".js-ckeditor").length&&loadAsset("window.CKEDITOR",e,function(){$(".js-ckeditor").each(function(e,t){if(!$("#cke_"+t.id).length){var o=app.ckeditor.buildConfiguration(t);o.placeholder=t.placeholder,CKEDITOR.replace(t.id,o)}}),app.ckeditor.bindCkeditorSubmit(),$(document).trigger("app:bind:ckeditor")})},buildConfiguration:function(e){var t={language:"pt-br",skin:"moono"};if(1==$(e).data("upload-image")){var o="/files/full_upload";t.extraPlugins="uploadimage",t.imageUploadUrl=o,t.filebrowserImageUploadUrl=o}return t},bindCkeditorSubmit:function(){$.each($(".js-ckeditor"),function(e,t){var o=$(t),n=o.parents("form"),a=o.attr("id"),s=n.find(".js-recaptcha").size();if(n){var i=n.find('button[type="submit"]'),t=CKEDITOR.instances[a];app.ckeditor.bindNotifications(t),t.on("change",function(){this.getData().length&&!s?i.attr("disabled",!1):i.attr("disabled",!0)})}}),$(document).trigger("app:bind:ckeditor_submit")},bindNotifications:function(e){var t=function(e){e.data.notification.override!==!0&&e.cancel()};e.on("notificationShow",t),e.on("notificationUpdate",t),e.on("fileUploadRequest",function(){e.notification=new CKEDITOR.plugins.notification(e,{message:e.lang.uploadwidget.uploadOne.replace("({percentage}%)",""),type:"progress",override:!0}),e.notification.show()}),e.on("fileUploadResponse",function(){e.notification.update({message:e.lang.uploadwidget.doneOne,type:"success"})})}}}(),function(){app.bindCollaborativeDiscussion=function(){$(document).on("click","#collaborative-discussion .js-edit-button",function(){var e=$(this).data("comment-id"),t=$("#js-comment-"+e);t.find(".js-show-comment").addClass("hide"),t.find(".js-edit-container").removeClass("hide")}),$(document).on("click","#collaborative-discussion .js-cancel-button",function(){var e=$(this).data("comment-id"),t=$("#js-comment-"+e);t.find(".js-show-comment").removeClass("hide"),t.find(".js-edit-container").addClass("hide")}),$(document).trigger("app:bind:collaborative_discussion")}}(),function(){app.accessibility=function(){var e=(function(){for(var e=[],t=$(".product-accessibility-list").find("li").find("a"),o=0;o<t.length;o++)e[o]=t[o];e.forEach(function(e){var t=e.innerHTML.replace(/\s+/g," ").replace("<span>","").replace("</span>","").replace("<a>","").replace("</a>",""),o=t.indexOf("R$"),n=t.indexOf("por"),a=t.indexOf(",");if(o!=-1){if(n!=-1){t=t.substring(o+3,t.length);var s=a+3;t=t.slice(0,s)+" reais"+t.slice(s,t.length)}else t=t.substring(o+3,a+3)+" reais";t=t.replace(",00","")}e.setAttribute("aria-label",t)})}(),function(){$("html").toggleClass("accessible"),$(".accessibility-constrast-state-on").toggleClass("hidden"),$(".accessibility-constrast-state-off").toggleClass("hidden")});$(".contrast-on-btn").on("click",function(){e()});var t=(function(){var e,t,o,n=(e={"":{pageName:"Página Inicial",divName:"home"},cart:{pageName:"Carrinho",divName:"cart"},sign_in:{pageName:"Fazer Login",divName:"login"},enrollments:{pageName:"Meus Cursos",divName:"enrollments"},forums:{pageName:"Fóruns",divName:"forums"},products:{pageName:"Produtos",divName:"products"},edit:{pageName:"Meu Perfil",divName:"profile"},certificates:{pageName:"Meus Certificados",divName:"certificates"},channels:{pageName:"Mensagens",divName:"messages"},orders:{pageName:"Meus Pedidos",divName:"orders"},profile:{pageName:"Perfil Público",divName:"profile"}},_defineProperty(e,"products",{pageName:"Matrículas",divName:"products"}),_defineProperty(e,"media",{pageName:"Portifólio",divName:"portifolio"}),e);t=window.location.href,o=t.search("/profile/")!=-1?t.search("products")!=-1?"products":t.search("media")!=-1?"media":"profile":t.substring(t.lastIndexOf("/")+1,t.length),window.$mainContentDiv=o&&n&&n[o]&&n[o].divName,o=o&&n&&n[o]&&n[o].pageName,o&&$("#accessibility-location").text("Você está em: "+o+" - Topo da Página")}(),function(e){var t=$(e);t.size()>0&&($(window).scrollTop(t.offset().top-50),t.focus())}),o=function(e){$mainContentDiv;if(null==e)var e=$(":focus").attr("id");switch(e){case"accessibility-btn-1":t("#accessibility-main-content-"+$mainContentDiv);break;case"accessibility-btn-2":t("#main-navbar");break;case"accessibility-btn-3":t("#accessibility-contact");break;case"accessibility-btn-4":t("#accessibility-location")}};$(window).keydown(function(e){if(!$(":focus").is("input"))switch(e.which){case 13:o();break;case 49:e.shiftKey&&o("accessibility-btn-1");break;case 50:e.shiftKey&&o("accessibility-btn-2");break;case 51:e.shiftKey&&o("accessibility-btn-3");break;case 52:e.shiftKey&&o("accessibility-btn-4")}}),$(document).trigger("app:bind:accessibility")}}(),function(){app.bindCourseRating=function(){$(document).on("rate-course",function(e,t){$("#js-rating-course-"+t+"-modal").modal()}),$(document).on("course-rating-created",function(e,t){$("#js-rating-course-"+t+"-modal").modal("hide")})}}(),function(){app.bindDatepicker=function(){$.fn.datepicker.defaults.language="pt-BR",$(".datepicker").each(function(e,t){var o=$(t),n=$('<input type="hidden" />').insertBefore(o.parent()),a=moment(o.val()).utc().format("DD/MM/YYYY"),s=moment(o.val()).utc().format("YYYY-MM-DD");s="Invalid date"===s?null:s,n.attr("id",o.attr("id")),n.attr("name",o.attr("name")),n.attr("value",s),o.removeAttr("id"),o.removeAttr("name"),""!==o.val()&&o.val(a),$(t).datepicker().on("change",function(){var e=moment(o.val(),"DD/MM/YYYY").utc().format("YYYY-MM-DD");e="Invalid date"===e?null:e,n.val(e)})}),$(document).trigger("app:bind:datepicker")}}(),function(){app.deadpoolChat={bindDeadpool:function(){var e="https://staging-cdn.eadbox.com/deadpooljs/dist.js";if(this.$deadpool=$(".deadpool-chat"),this.$jwt=this.$deadpool.data("jwt"),this.$message_list=$(".chat-message-list"),this.$message_inputs=$(".message-inputs"),this.$chat_room=this.$deadpool.data("chat-room"),this.$is_before=this.$deadpool.data("is-before"),this.$message_form=$("form#message"),this.$message_input=this.$message_form.find("textarea[name=message-body]"),this.$is_before){var t={type:"exclamation",message_body:"Esse Webinar ainda não começou"};app.deadpoolChat.renderNewMessage(app.deadpoolChat.buildNotification(t))}else if(this.$deadpool.length){var o=this;loadAsset("Deadpool",e,function(){try{deadpool["default"].on("connected",function(){app.deadpoolChat.joinRoom()}),deadpool["default"].on("connection_failed",function(){var e={type:"close",message_body:"Falha ao conectar com o chat!"};app.deadpoolChat.renderNewMessage(app.deadpoolChat.buildNotification(e))}),deadpool["default"].on("disconnected",function(){var e={type:"exclamation",message_body:"A conexão com o chat foi encerrada!"};app.deadpoolChat.renderNewMessage(app.deadpoolChat.buildNotification(e))}),deadpool["default"].connect("wss://deadpool.herospark.com/chat-service",o.$jwt)}catch(e){console.log(e)}$(document).trigger("app:deadpool:connected")}),$(document).trigger("app:bind:deadpool")}},renderNewMessage:function(e){var t=moment(e.date).format("HH:mm");if(this.$is_before||e.notification)var o=$('\n          <div class="row message-item">\n            <div class="col-md-12 message-header">\n              <i class="icon-'+e.type+'"> '+e.message+"</i>\n            </div>\n          </div>\n        ");else var o=$('\n          <div class="row message-item">\n            <div class="message-header">\n              <div class="col-md-9">\n                <h5>'+e.user.name+'</h5>\n              </div>\n              <div class="col-md-3 message-timestamp">\n                <span class="message-timestamp">'+t+'</span>\n              </div>\n            </div>\n            <div class="col-md-12 message-body">\n              <p>'+e.message+"</p>\n            </div>\n          </div>\n        ");this.$message_list.append(o)},joinRoom:function(){var e=this;try{deadpool["default"].on("joined_room",function(){var t={type:"check",message_body:"Conectado ao chat com sucesso!"};app.deadpoolChat.bindMessageEvents(),app.deadpoolChat.bindPresenceEvent(),e.$message_inputs.removeAttr("disabled"),app.deadpoolChat.renderNewMessage(app.deadpoolChat.buildNotification(t))}),deadpool["default"].on("join_timeout join_crashed join_failed",function(){var e={type:"close",message_body:"Falha ao conectar com o chat!"};app.deadpoolChat.renderNewMessage(app.deadpoolChat.buildNotification(e))}),deadpool["default"].on("closed_room",function(){var e={type:"exclamation",message_body:"O chat da transmissão foi encerrado!"};app.deadpoolChat.renderNewMessage(app.deadpoolChat.buildNotification(e))}),deadpool["default"].join(this.$chat_room)}catch(t){console.log(t)}},bindMessageEvents:function(){var e=this;deadpool["default"].on("new_message",function(t){var o=e.$message_list.scrollTop()+e.$message_list.height()==e.$message_list.prop("scrollHeight");app.deadpoolChat.renderNewMessage(t),o&&e.$message_list.animate({scrollTop:e.$message_list.prop("scrollHeight")},0)}),deadpool["default"].on("message_sent",function(t){var o=e.$message_list.scrollTop()+e.$message_list.height()==e.$message_list.prop("scrollHeight");app.deadpoolChat.renderNewMessage(t),o&&e.$message_list.animate({scrollTop:e.$message_list.prop("scrollHeight")},0)}),this.$message_input.on("keyup",function(e){13===e.keyCode&&(e.preventDefault(),app.deadpoolChat.submitMessage())}),this.$message_form.on("submit",function(e){e.preventDefault(),app.deadpoolChat.submitMessage()}),deadpool["default"].on("message_failed message_timeout",function(){var e={type:"close",message_body:"Falha ao enviar messagem!"};app.deadpoolChat.renderNewMessage(app.deadpoolChat.buildNotification(e))})},bindPresenceEvent:function(){deadpool["default"].on("presence",function(e){$("#watch-number").text(" "+e.length)})},submitMessage:function(){var e=this.$message_input.val();this.$message_input.val(""),deadpool["default"].sendMessage(e)},buildNotification:function(e){var t={notification:!0,type:e.type,message:e.message_body};return t}}}(),function(){app.bindExamQuestionForm=function(){$(document).on("click","#js-remake-exam",function(){$("#answers-container").addClass("hide"),$("#form-container").removeClass("hide")}),$(document).on("click",".js-clean-associative-options",function(){$(this).parents(".associative-question").find(".js-associative-select option:selected").removeAttr("selected")}),$(document).on("change",".js-associative-select",function(){var e=$(this).parents(".associative-question"),t=$(this).data("option-index"),o=$(this).find("option:selected").data("first-assertion-id");e.find('.js-associate-assertion[data-option-index="'+t+'"]').val(o)}),$(document).on("change","#exam_answer_form",app.checkFormValidity),$(document).on("input propertychange","#exam_answer_form",app.checkFormValidity),$(document).trigger("app:bind:bind_exam_question_form")}}(),function(){app.bindFixOnScroll=function(){$(".js-fix-on-scroll").each(function(e,t){if($(t).hasClass("js-fix-on-scroll-mobile")||!(window.innerWidth<992)){var o=$(t);o.wrap('<div class="js-fix-scroll-wrapper"/>');var n=o.parent(".js-fix-scroll-wrapper"),a=o.offset(),s={width:o.outerWidth(),height:o.outerHeight()};n.width(s.width),n.height(s.height),$(document).on("scroll",function(e){var t=$(document).scrollTop();if(t>=a.top){if("fixed"===o.css("position"))return;o.parent().addClass("scroll"),o.addClass("scroll"),o.css({position:"fixed",left:a.left,top:0,width:s.width,height:s.height,"z-index":"10000"})}else{if("static"===o.css("position"))return;o.removeClass("scroll"),o.parent().removeClass("scroll"),o.css({position:"static",left:"auto",top:"auto",width:"auto",height:"auto"})}})}})}}(),function(){app.followBind=function(){$(document).on({mouseenter:function(){$(this).addClass("hidden"),$("#js-unfollow").removeClass("hidden")}},"#js-following"),$(document).on({mouseleave:function(){$("#js-following").removeClass("hidden"),$(this).addClass("hidden")}},"#js-unfollow")}}(),function(){app.bindForumFeed=function(){$(document).on("click",".js-collapse-toggle-text",function(e){e.preventDefault();var t=$(this),o=t.data("open-text"),n=t.data("close-text"),a=$(t.attr("href"));a.hasClass("in")?(a.collapse("hide"),t.html(n)):(a.collapse("show"),t.html(o),app.bindBlazy())}),$(document).on("fix_forum_feed",function(){app.fixForumFeed()}),$(document).on("forum_feed_post_created",function(e,t){var o=$("#js-topic-item-"+t+" .js-posts-count"),n=o.find(".size"),a=parseInt(n.html());n.html(a+1),o.removeClass("hidden"),$("#js-topic-"+t+"-posts").removeClass("hidden"),$("#js-topic-"+t+"-posts-list-panel").collapse("show"),app.fixForumFeed()}),$('a[data-toggle="tab"]').on("shown.bs.tab",function(e){app.fixForumFeed()})},app.fixForumFeed=function(){app.bindGlobal(),app.bindBlazy()}}(),function(){var e=function(e,t,o){return("/enrollments/:enrollment_id/courses/:course_id/"+o).replace(":enrollment_id",e).replace(":course_id",t)},t=function(t,o,n){if(null===o||null===t)return!1;console.warn("executed: lessonList.getPaymentMethod");var a=$.ajax({url:e(t,o,"payment_method"),async:!1,headers:{Authorization:"Token token="+n}});return a&&a.responseJSON.payment_method},o=function(t,o,n){if(null===o||null===t)return!1;console.warn("executed: lessonList.getLessonInfo");var a=$.ajax({url:e(t,o,"lessons_info"),async:!1,headers:{Authorization:"Token token="+n}});return a&&a.responseJSON.lessons_info};app.lessonList={onTrial:{},paymentMethod:void 0,init:function(){var e=this;if(e.courseTreeExists=e.courseTree().length,e.isActive=e.courseTree().data("is-active"),e.course=e.courseTree().data("course"),e.enrollment=e.courseTree().data("enrollment"),e.courseContent=e.courseTree().data("course-content"),e.userType=e.courseTree().data("user-type"),e.lessonActions=e.courseTree().data("lesson-actions"),e.downloadAction=e.courseTree().data("download-action"),e.currentLessonId=parseInt(e.courseTree().data("current-lesson-id")),e.hasRequirements=$(".lesson-list-panel [data-requirements]").length>0,e.apiKey=e.courseTree().data("api-key"),e.translations={},e.translations["lesson.release_at"]=e.courseTree().data("translation-release-at"),e.translations["lesson.release_after"]=e.courseTree().data("translation-release-after"),e.translations["lesson.lock_at"]=e.courseTree().data("translation-lock-at"),e.translations["lesson.lock_after"]=e.courseTree().data("translation-lock-after"),e.translations["product.course_content.views"]=e.courseTree().data("translation-course_content-views"),e.renderAttendanceElement&&$(document).on("activated-lesson",function(){e.renderAttendanceElement()}),e.course&&e.enrollment){var t=o(e.enrollment.id,e.course.id,e.apiKey);e.courseTree().data("enrollment",Object.assign({},e.enrollment,{lessons_info:t}))}e.lessonProgress()&&e.lessonProgress().completed&&$(".btn-next-lesson").removeClass("disabled"),e.lessonProgress()&&!e.lessonProgress().completed&&e.progressIcon("progress").removeClass("hide"),e.hasRequirements&&e.checkNextButtonUnlocked(),e.courseTreeExists&&!e.isActive&&(e.bindClicks(),e.handleLessons(),e.loadTopModules(),e.bindChangeLesson(),$(document).trigger("app:bind:lesson_sidebar"),$(document).on("lesson-completed",function(t,o){var n=$(".btn-next-lesson"),a=o.data.enrollment_id;e.progressIcon("completed").hasClass("hide")&&e.progressIcon("completed").removeClass("hide"),e.progressIcon("progress").hasClass("hide")||e.progressIcon("progress").addClass("hide"),n.size()>0&&n.removeClass("disabled"),app.lessonList.requirementsExists(o.data,function(e,t){e&&t&&app.lessonList.checkLessonCompleted(a,t,function(t){t&&(e.removeClass("blocked"),e.find(".right > .icon-lock").remove())})})}))},courseTree:function(){return $(".course-content #js-course-tree-ajax")},lazyLoadButtons:function(){return $(".course-content #js-course-content-more-link, .course-content #js-course-content-prev-link")},lessons:function(){return this.courseTree().find(".js-content")},currentLesson:function(){return $(this.courseTree().find(".js-content.active")[0])},toggleButton:function(){return $(".lesson-list-toggle .btn")},lessonListPanel:function(){return $(".lesson-list-panel")},lessonProgress:function(){return $("#js-media-player").data("lesson-progress")},progressIcon:function(e){var t={completed:".js-completed-icon",progress:".js-in-progress-icon"};return this.currentLesson().find(t[e])},requirementsExists:function(e,t){if(!e)return!1;var o=$(".lesson-list-panel [data-requirements]").filter(function(e,t){return $(t).data("requirements").length>0}),n=o.map(function(e,t){return{item:$(t),requirements:$(t).data("requirements")}}).toArray(),a=_.find(n,{requirements:[{content_id:e.lesson_id}]});if(a){var s=a.item;if(t)return t(s,e.lesson_id)}else if(t)return t(null);
},checkLessonCompleted:function(e,t,o){var n=!1,a=$(".course-content #js-course-tree-ajax").data("api-key");$.ajax({url:window.CORE_HOST+"/enrollments/"+e+"/lessons_progresses?lesson_id="+t,method:"GET",headers:{Authorization:"Token token="+a}}).success(function(e){n=e.lessons_progresses[0].completed,o(n)})},bindChangeLesson:function(){var e=this;if(!e.bindChangeLessonActive){e.bindChangeLessonActive=!0;var t=/enrollments\/\d+\/courses\/\d+$/,o=/enrollments\/\d+\/courses\/\d+\/course_contents\/\d+$/;$(document).on("ready page:load",function(n){var a=window.location.pathname,s=o.test(a);if((t.test(a)||s)&&(e.lessons().removeClass("active"),s)){var i=a.split("/"),r=i[i.length-1];$("#content-"+r+".js-content").addClass("active")}})}},bindClicks:function(){var e=this;e.lessons().find("a").on("click",function(e){e.preventDefault(),app.lessonList.changeLesson(null,$(this).parents(".js-content"))}),e.courseTree().on("click",".module",function(t){($(t.target).hasClass("module")||$(t.target).parent().hasClass("module"))&&(t.stopPropagation(),e.loadChildren($(this)))}),e.courseTree().data("is-active",!0),e.toggleButton().on("click",this.toggleSidebar)},getLessonIcon:function(e){var t="";if("ExamLesson"===e.type&&e.activity)switch(e.activity.type){case"Quiz":t="icon-puzzle";break;case"FileUpload":t="icon-arrow-up-circle";break;case"CollaborativeDiscussion":t="icon-people";break;default:t="icon-puzzle"}else if(e.media)switch(e.media.type){case"Video":t="icon-camrecorder";break;case"Audio":t="icon-microphone";break;case"Slide":t="icon-chart";break;case"Document":t="icon-doc";break;case"Image":t="icon-picture";break;case"Text":t="icon-doc";break;case"LiveStream":t="icon-control-play";break;case"VideoSlide":t="icon-film";break;case"ScormPackage":t="icon-layers";break;case"Html":t="icon-doc";break;case"Html5":t="icon-docs";break;default:t="icon-camrecorder"}return t},getContentPath:function(e){var t=this,o=t.enrollment.id,n=t.course.id,a=o?"/enrollments/"+o:"/admin_view";return a=a+"/courses/"+n+"/course_contents/"+e.id},getContentDownloadPath:function(e){var t=this;return t.getContentPath(e)+"/download"},checkLessonLocked:function(e,t){var o=e.lock_at,n=e.lock_after;if("Collaborator"===t)return!1;if(!o&&!n)return!1;var a=moment(this.enrollment.activated_at).startOf("day"),s=o?moment(o).startOf("day"):a.add(n,"days");return moment().startOf("day")>=s},checkLessonAvailability:function(e){var t=e.release_at,o=e.release_after;if(!t&&!o)return!0;var n=moment(this.enrollment.activated_at).startOf("day"),a=t?moment(t).startOf("day"):n.add(o,"days");return moment().startOf("day")>=a},checkTrialByType:function(o,n){var a=this,s=a.apiKey,i="trial_"+o+"_ids",r=a.enrollment&&a.enrollment.id,l=a.course&&a.course.id,c=$("#js-course-tree-ajax"),d=c.data("enrollment"),u=c.data("school-product");a.paymentMethod=void 0!==a.paymentMethod?a.paymentMethod:t(r,l,s);var p=u&&u.trial_constrains,m=p&&a.paymentMethod&&p[a.paymentMethod]||{},f=Object.keys(m).length>0;if(null!==r&&null!==l&&!a.onTrial.hasOwnProperty(r)){var h=$.ajax({url:e(r,l,"on_trial"),async:!1,headers:{Authorization:"Token token="+s}});a.onTrial[r]=h&&h.responseJSON.on_trial}return!(f&&!m.hasOwnProperty(i))&&(f&&m[i]?m[i].indexOf(n)>-1:!(!d||!a.onTrial[r])&&a.onTrial[r])},fetchModules:function(e){var t=this,o=e.data("id"),n=e.data("level"),a=e.find(".list-group").first();return $.ajax({url:window.CORE_HOST+"/course_modules/"+o,method:"GET",headers:{Authorization:"Token token="+t.apiKey},success:function(e){var o=_.sortBy(e.course_modules,"order");o=_.filter(o,function(e){var o=_.find(t.allModules,{id:e.id});return o.available!==!1&&(o.course_content_ids.length>0||o.course_modules.length>0)});var s=_.map(o,function(e){return $('<li class="list-group-item module" data-id="'+e.id+'"data-level="'+(n+1)+'"><i class="icon icon-arrow-right"></i><span>'+e.name+'</span><i class="busy busy-xs"></i></li>')});a.append(s)}})},fetchChildren:function(e){var t=this,o=e.data("id"),n=(e.data("level"),e.find(".list-group").first());return $.ajax({url:window.CORE_HOST+"/course_modules/"+o+"/course_contents",method:"GET",headers:{Authorization:"Token token="+t.apiKey},success:function(e){var o=_.filter(e.course_contents,function(e){return e.available!==!1});o=_.sortBy(o,"order"),t.enrollment&&(o=_.map(o,function(e){return e.completed=t.enrollment.lessons_info&&t.enrollment.lessons_info.completed.indexOf(e.lesson.id)>-1,e}));var a=_.map(o,function(e){var o=t.currentLessonId===e.lesson.id?"active js":"",n=e.lesson,a=t.getLessonIcon(n),s="hide",i="hide",r=null,l=null,c=null,d=null,u=null,p=null,m=null,f=e.requirements,h=!0;t.enrollment&&(r=t.checkLessonAvailability(n)||"Collaborator"===t.userType,d=t.checkLessonLocked(n,t.userType),t.enrollment.lessons_info&&t.enrollment.lessons_info.completed.indexOf(n.id)>-1?(s="hide",i=null):t.enrollment.lessons_info&&t.enrollment.lessons_info.in_progress.indexOf(n.id)>-1?(s=null,i="hide"):(s="hide",i="hide"),n.release_at?(l="release_at",c=n.release_at):n.release_after&&(l="release_after",c=moment(t.enrollment.activated_at).add(n.release_after,"days")),n.lock_at?(u="lock_at",p=n.lock_at):n.lock_after&&(u="lock_after",p=moment(t.enrollment.activated_at).add(n.lock_after,"days")),t.lessonActions&&(m=_.find(t.enrollment.lessons_progresses,{lesson_id:n.id})),_.each(f,function(e){var o=t.enrollment.lessons_info&&t.enrollment.lessons_info.completed.indexOf(e.content_id)>-1||"Collaborator"===t.userType;o||(h=!1)})),e.completed&&$(".btn-next-lesson").removeClass("disabled");var g='<li class="list-group-item content-lesson js-content list-group-item lesson module-item '+o+(!h||t.enrollment&&t.checkTrialByType("content",e.id)?" blocked":"")+'" id="content-'+e.id+"\" data-requirements='"+JSON.stringify(f)+"'data-id=\""+e.lesson.id+'"data-level="1"><div id="lesson-'+n.id+'" class="js-lesson content-lesson '+o+(r?"":" not-released")+(d?" lesson-locked":"")+'" data-lesson-id="'+n.id+'"><div class="class-info"><div class="left"><i class="'+a+'"></i></div><div class="center">'+(t.lessonActions&&r&&!d?'<a class="lesson-title" href="'+t.getContentPath(e)+'"><span>'+n.title+"</span></a>":'<span class="lesson-title"><span class="disabled">'+n.title+"</span></span>")+'</div><div class="right">'+(!h||t.enrollment&&t.checkTrialByType("content",e.id)?'<i class="icon-lock"></i>':"")+'<span class="progress-icon js-progress-icons"><i class="icon-check js-completed-icon '+i+'"></i><i class="icon-clock js-in-progress-icon '+s+'"></i></span>';if(t.lessonActions){if(m&&m.views<=t.enrollment.max_attendance_length&&"attempts"==t.enrollment.max_attendance_type){var v=t.translations["product.course_content.views"];v=v.replace("{{ progress.views }}",m.views),v=v.replace("{{ enrollment.max_attendance_length }}",t.enrollment.max_attendance_length),g+='<span class="lesson-views attempt js-attendance badge" title="'+v+'" data-tooltip-placement="left" data-toggle="tooltip"><span>'+m.views+"/"+t.enrollment.max_attendance_length+"</span></span>"}if(!r){var b=moment.tz.guess();g+='<span class="release-date badge">'+t.translations["lesson."+l]+"<span> "+moment.tz(c,b).format("DD/MM/YYYY")+"</span></span>"}if(d){var b=moment.tz.guess();g+='<span class="lesson-locked-date badge">'+t.translations["lesson."+u]+"<span> "+moment.tz(p,b).format("DD/MM/YYYY")+"</span></span>"}var y=e.lesson.media&&["Document","Audio","Download"].indexOf(e.lesson.media.type)>-1;(t.downloadAction||e.downloadable)&&y&&(g+='<a class="download-link" href="'+t.getContentDownloadPath(e)+'" data-no-turbolink><i class="icon-cloud-download"></i></a>')}return g+="</div></div></li>",$(g)});n.append(a),t.checkNextButtonUnlocked(),$(document).trigger("loaded-children")}})},renderAttendanceElement:function(){var e=this;if(!e.lessonProgress)return!1;var t=e.lessonProgress(),o=e.translations["product.course_content.views"];o=o.replace("{{ progress.views }}",t.views),o=o.replace("{{ enrollment.max_attendance_length }}",e.enrollment.max_attendance_length);var n=$(".js-lesson[data-lesson-id="+t.lesson_id+"] .right"),a=t&&t.views<=e.enrollment.max_attendance_length&&"attempts"==e.enrollment.max_attendance_type;if(0===n.find(".js-attendance").size()&&e.lessonActions&&a){var s='<span class="lesson-views attempt js-attendance badge" title="'+o+'" data-tooltip-placement="left" data-toggle="tooltip"><span>'+t.views+"/"+e.enrollment.max_attendance_length+"</span></span>";n.append(s)}},checkNextButtonUnlocked:function(){var e=this.lessonProgress();app.lessonList.requirementsExists(e,function(t,o){if(t&&o){if(!o||!e.hasOwnProperty("enrollment_id"))return;app.lessonList.checkLessonCompleted(e.enrollment_id,o,function(e){e&&($(".btn-next-lesson").removeClass("disabled"),t.removeClass("blocked"),t.find(".right > .icon-lock").remove())})}else $(".btn-next-lesson").removeClass("disabled")})},loadTopModules:function(){var e=this;e.course&&$.ajax({url:window.CORE_HOST+"/courses/"+e.course.id+"/course_modules",method:"GET",headers:{Authorization:"Token token="+e.apiKey},success:function(t){if(t.course_modules&&!(t.course_modules.length<=0)){e.allModules=t.course_modules,e.topModules=_.filter(t.course_modules,function(e){return!e.parent_course_module&&e.available!==!1&&(e.course_content_ids.length>0||e.course_modules.length>0)}),e.topModules=_.sortBy(e.topModules,"order");var o=_.map(e.topModules,function(t){var o=e.enrollment&&e.checkTrialByType("module",t.id);return $('<li class="list-group-item module '+(o?"disabled":"")+'" data-id="'+t.id+'"data-level="1"><i class="icon icon-arrow-right"></i><span>'+t.name+'</span><i class="busy busy-xs"></i></li>')});e.courseTree().prev(".course-content-busy").fadeOut("fast",function(){e.courseTree().css("display","none"),e.courseTree().html(o),e.courseTree().fadeIn("fast"),e.courseContent&&e.expandParentModules(e.courseContent.parent_modules_hash)})}}})},loadChildren:function(e,t){var o=this,n=$(e),a=(n.data("id"),n.data("level"),n.find(".list-group").first());a.length<=0?(n.find(".busy").css({opacity:1}),a=$('<ul class="list-group" style="display: none;"></ul>'),a.appendTo(n),$.when(o.fetchModules(n),o.fetchChildren(n)).then(function(){n.addClass("expanded"),n.find(".busy").css({opacity:0}),a.slideDown("fast"),"function"==typeof t&&t()})):(n.hasClass("expanded")?(n.removeClass("expanded"),a.slideUp("fast")):(n.addClass("expanded"),a.slideDown("fast")),"function"==typeof t&&t())},handleLessons:function(){$(document).on("page:load page:restore",function(e){if(e.originalEvent&&e.originalEvent.data&&0!=e.originalEvent.data.length){var t=$(e.originalEvent.data[0]);app.lessonList.lessons().each(function(e,o){var n=$(o),a=t.find("#"+n.attr("id"));n.html(a.html())})}})},changeLesson:function(e,t){var o=$(t);if("prev"===e){var n=app.lessonList.currentLesson().prevAll(".js-content");n.length>0&&n.find("a").length>0&&(o=$(n[0]))}else if("next"===e){var a=app.lessonList.currentLesson().nextAll(".js-content");a.length>0&&a.find("a").length>0&&(o=$(a[0]))}o.find("a")[0].click()},expandParentModules:function(e){var t=this,o=[],n=e.course_module;for(o.push(n.id);n.parent_module;)n=n.parent_module,o.push(n.id);o=o.reverse(),async.eachSeries(o,function(e,o){var n=$('.module[data-id="'+e+'"]');t.loadChildren(n,o)})},toggleSidebar:function(){app.lessonList.toggleButton().toggleClass("active"),app.lessonList.lessonListPanel().toggleClass("active")}}}(),function(){app.lessonPage=function(){var e=/\/collaborative_discussions\/([0-9]+)\/collaborative_comments/,t=/\/exam_answers/,o=function(t){return e.test(t)},n=function(e){return t.test(e)};$(document).ajaxSuccess(function(e,t,a){if(o(a.url)||n(a.url)){var s=app.lessonList.lessonProgress();app.lessonList.requirementsExists(s,function(e,t){t&&s.enrollment_id&&app.lessonList.checkLessonCompleted(s.enrollment_id,t,function(t){if(t){var o=app.lessonList.currentLesson().find(".js-in-progress-icon");o.removeClass("icon-clock"),o.removeClass("js-in-progress-icon"),o.addClass("js-in-completed-icon"),o.addClass("icon-check"),$(".btn-next-lesson").removeClass("disabled"),e.removeClass("disabled"),e.removeClass("blocked"),e.find(".right > .icon-lock").remove()}})},function(){$(".btn-next-lesson").removeClass("disabled")})}})}}(),function(){app.bindMasks=function(){var e=function(e){return 11===e.replace(/\D/g,"").length?"(00) 00000-0000":"(00) 0000-00009"},t={onKeyPress:function(t,o,n,a){n.mask(e.apply({},arguments),a)}};$("#user-phone").mask(e,t),$("#user-cpf").mask("999.999.999-99"),$("#user-cep").mask("99.999-999"),$(document).trigger("app:bind:masks")}}(),app.notepad={page:1,noteContainer:function(){return $("#notepad-container")},form:function(){return $("#js-notepad-form")},loadNote:function(e,t){$.ajax({url:window.location.pathname+"/notepads",method:"GET",success:function(){"function"==typeof t&&t()}})},saveNote:function(e){var t=$("#js-note").html(),o=$("#js_note_id").val(),n=$("#save_notepad_button"),a=n.html();n.html(n.data("sending")),n.prop("disabled",!0),$.ajax({url:window.location.pathname+"/notepads",method:"POST",data:{_id:o,note:t},success:function(){n.html(a),n.prop("disabled",!1),"function"==typeof e&&e()}})},init:function(){var e=this;this.noteContainer().length<=0||(this.loadNote($("#lesson_id").val()),$("#notepad_form").on("submit",function(t){t.preventDefault(),e.saveNote()}))}},function(){app.bindPostsForm=function(){$(document).on("click",".js-post-edit",function(){var e=$(this).parents(".js-post");e.find(".js-post-body").addClass("hidden"),e.find(".js-post-form").removeClass("hidden")}),$(document).on("click",".js-post-cancel",function(e){var t=$(this).parents(".js-post");t.find(".js-post-body").removeClass("hidden"),t.find(".js-post-form").addClass("hidden")}),$(document).trigger("app:bind:bind_posts_form")}}(),function(){app.bindReadMore=function(){$('[role="readmore"]').each(function(e,t){var o=$(t).data("speed")||100,n=$(t).data("collapsed-height")||200,a=$(t).data("more-text")||"Leia Mais",s=$(t).data("less-text")||"Fechar",i=$(t).innerHeight(),r=i<=n;$(t).readmore({speed:o,collapsedHeight:n,moreLink:'<a href="#" class="'+(r?"hidden":"readmore-link")+'">'+a+"</a>",lessLink:'<a href="#" class="'+(r?"hidden":"readmore-link")+'">'+s+"</a>"})})}}(),function(){window.onLoadRecaptcha=function(){app.bindRecaptcha()},app.bindRecaptcha=function(){var e=$(".js-recaptcha");e.length&&"undefined"!=typeof grecaptcha&&grecaptcha.hasOwnProperty("render")&&e.each(function(e,t){var o=$(t),n=o.data("sitekey"),a=o.attr("id"),s=o.data("disable-button")===!0,i=o.data("button-selector"),r=o.parents("form"),l=i?r.find(i):r.find('button[type="submit"], input[type="submit"]');s&&l.prop("disabled",!0),grecaptcha.render(a,{sitekey:n,callback:function(){s&&l.prop("disabled",!1)}})})}}(),function(){app.simpleEditor={createShortcut:function(e,t){var o=navigator.platform.toUpperCase().indexOf("MAC")>=0,n=function(n){var a=String.fromCharCode(n.keyCode),s=n.ctrlKey,i=!!n.metaKey,r=0;if(o&&i?r++:s&&r++,a===e&&(r++,2===r))return n.stopPropagation(),n.preventDefault(),t()};$("body").bind("keydown",n)},handleDrag:function(e){e.stopPropagation(),e.preventDefault()},handleDrop:function(e){e.stopPropagation(),e.preventDefault();var t=e.clientX,o=e.clientY,n=e.dataTransfer.files[0],a=window.URL||window.webkitURL,s=a.createObjectURL(n);if(n.type.match("image.*")){var i=document.createElement("img");i.src=s;var r=null;if(document.caretPositionFromPoint){var l=document.caretPositionFromPoint(t,o);r=document.createRange(),r.setStart(l.offsetNode,l.offset),r.collapse(),r.insertNode(i)}else document.caretRangeFromPoint&&(r=document.caretRangeFromPoint(t,o),r.insertNode(i))}},updateButtons:function(){var e=document.queryCommandState("Bold"),t=document.queryCommandState("Italic"),o=document.queryCommandState("Underline");e===!0?$("[data-action=bold]").addClass("active"):$("[data-action=bold]").removeClass("active"),t===!0?$("[data-action=italic]").addClass("active"):$("[data-action=italic]").removeClass("active"),o===!0?$("[data-action=underline]").addClass("active"):$("[data-action=underline]").removeClass("active")},init:function(e){this.$container=$(e),this.$container.length<=0||(this.$input=this.$container.find(".js-input"),this.$btnAction=this.$container.find(".js-btn-action"),this.registerTriggers(),this.registerDropZone(),this.registerShortcuts())},registerTriggers:function(){var e=this;e.$btnAction.on("click",function(){var e=$(this).attr("data-action");document.execCommand(e),app.simpleEditor.updateButtons()}),e.$input.on("click",function(){app.simpleEditor.updateButtons()}),e.$input.on("focusin",function(){e.$container.addClass("focused")}),e.$input.on("focusout",function(){e.$container.removeClass("focused")})},registerDropZone:function(){var e=$(this.container).find(".js-input");e.on("dragover",app.simpleEditor.handleDrag,!1),e.on("drop",app.simpleEditor.handleDrop,!1)},registerShortcuts:function(){app.simpleEditor.createShortcut("U",function(){document.execCommand("underline"),app.simpleEditor.updateButtons()}),app.simpleEditor.createShortcut("B",function(){document.execCommand("bold"),app.simpleEditor.updateButtons()}),app.simpleEditor.createShortcut("I",function(){document.execCommand("italic"),app.simpleEditor.updateButtons()})}}}(),function(){app.randomQuizStatistics=function(){for(var e=$(".statistic"),t=[],o=[],n=function(t){return e[a].attributes[t].value},a=0;a<e.size();a++){var s=n("data-tag"),i=n("data-difficulty"),r=n("data-quantity"),l=n("data-hits");t.push({id:s+"-"+i,quantity:r,hits:l,tag:s,difficulty:i})}for(var c=_.uniqBy(t,"id"),a=0;a<c.length;a++){var d=c[a].id,u=_.filter(t,_.matches({id:d})),p=0,m=0,f="",h="";_.forEach(u,function(e){p+=parseInt(e.quantity),m+=parseInt(e.hits),f=e.tag,h=e.difficulty});var g=p-m,v=(m/p*100).toFixed()+"%";o.push({tag:f,difficulty:h,total:p,correct_anwsers:m,wrong_answers:g,performance:v})}var b=$(".statistic-texts").first().data(),y=$("#course-statistics");_.forEach(o,function(e){var t='<div class="row statistic-item">    \n                <div class="statistics-board">        \n                    <div class="row statistic-label">\n                        <h2 class="tag">'+e.tag+'</h2>\n                        <h2 class="difficulty">'+e.difficulty+'</h2>\n                    </div>\n                    <div class="col-md-3 box-outline">\n                        <div class="statistic-box total">\n                            <p class="result">'+e.total+'</p>\n                            <p class="name">'+b.textAnswered+'</p>\n                            <div class="box-footer">        \n                            </div>\n                        </div>\n                    </div> \n                    <div class="col-md-3 box-outline">\n                        <div class=" statistic-box correct">\n                            <p class="result">'+e.correct_anwsers+'</p>\n                            <p class="name">'+b.textRight+'</p>\n                            <div class="box-footer">\n                            </div>\n                        </div>\n                    </div>\n                    <div class="col-md-3 box-outline">\n                        <div class="statistic-box wrong">\n                            <p class="result">'+e.wrong_answers+'</p>\n                            <p class="name">'+b.textWrong+'</p>\n                            <div class="box-footer">\n                            </div>\n                        </div>\n                    </div>\n                    <div class="col-md-3 box-outline">\n                        <div class="statistic-box performance">\n                            <p class="result">'+e.performance+'</p>\n                            <p class="name">'+b.textPerformance+'</p>\n                            <div class="box-footer">\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>';y.append(t)}),$(document).trigger("app:bind:randomQuizStatistics")}}(),function(){var e=function(e){var t=0,o=/[a-z]+/,n=/[A-Z]+/,a=/\d+/,s=/.[!,@,#,$,%,^,&,*,?,_,~,-,(,)]/;return e.length>=6&&t++,e.match(o)&&e.match(n)&&t++,e.match(a)&&t++,e.match(s)&&t++,e.length>12&&t++,t};app.bindStrongPassword=function(){var t=$(".strong--password"),o=t.parents("form:first"),n=o.find(".alert");$(".strong--password").bind("change focus paste keyup",function(){""!==$(this).val()&&e($(this).val())>=3?(n.hide(),o.find('input[type="submit"]').removeClass("disabled")):(n.show(),o.find('input[type="submit"]').addClass("disabled"))}).bind("blur",function(){n.hide()})}}(),app.studentDoubts={page:1,doubtsContainer:function(){return $("#js-doubts-container")},form:function(){return $("#js-student-doubts-form")},expandButton:function(){return $("#js-expand-student-doubts-form")},hideButton:function(){return $("#js-hide-student-doubts-form")},loadMoreButton:function(){return $("#js-load-more-doubts")},loadDoubts:function(e){var t=this;$.ajax({url:window.location.pathname+"/student_doubts/page/"+t.page,method:"GET",data:{per_page:3},complete:function(){"function"==typeof e&&e()}})},init:function(){var e=this;e.doubtsContainer().length<=0||(e.expandButton().on("click",function(){e.expandButton().hide(),e.form().slideDown("fast")}),e.hideButton().on("click",function(){e.form().slideUp("fast",function(){e.expandButton().fadeIn("fast")})}),e.loadMoreButton().on("click",function(){e.page=e.page+1;var t=$(this);t.attr("disabled","disabled"),e.loadDoubts(function(){t.removeAttr("disabled")})}),e.loadDoubts())}},function(){app.timeTags=function(){var e=$(".js-edools-player");if(!(e.length<=0)){var t=e[0].edoolsPlayer;$(".js-timetags .list-group-item").on("click",function(o){if(o.preventDefault(),e.length>0){var n=$(this).data("time");t.setTime(n)}})}}}(),function(){app.changeTimeZone=function(){$(".js-to-client-timezone").each(function(e,t){var o=$(t),n=o.data("format"),a=moment.tz.guess(),s=o.data("timezone");o.html(moment.tz(s,a).format(n))}),$(document).trigger("app:change:timezone")},app.changeTimeZone()}(),function(){$(document).on("page:load",function(){app.init()}),$(document).on("page:partial-load",function(){app.bindBlazy()}),$(document).ready(function(){app.init()})}();
//
